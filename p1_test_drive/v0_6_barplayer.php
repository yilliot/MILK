<?php
$birthday_song_track = array(
	0 => array('instrument'=>'guitar')
);
$birthday_song_slot = array(
	array( 'bpm' => 140, 'nn'  => 3, 'dd'  => 4, 'sf'  => 0, 'mi'  => 0 , 'direction' => array('0'=>1,'1'=>1) ),
	array( 'bpm' => 140, 'nn'  => 3, 'dd'  => 4, 'sf'  => 0, 'mi'  => 0 , 'direction' => array('0'=>2,'1'=>2) ),
	array( 'bpm' => 140, 'nn'  => 3, 'dd'  => 4, 'sf'  => 0, 'mi'  => 0 , 'direction' => array('0'=>3,'1'=>3) ),
	array( 'bpm' => 140, 'nn'  => 3, 'dd'  => 4, 'sf'  => 0, 'mi'  => 0 , 'direction' => array('0'=>4,'1'=>4) ),
	array( 'bpm' => 140, 'nn'  => 3, 'dd'  => 4, 'sf'  => 0, 'mi'  => 0 , 'direction' => array('0'=>5,'1'=>5) ),
	array( 'bpm' => 140, 'nn'  => 3, 'dd'  => 4, 'sf'  => 0, 'mi'  => 0 , 'direction' => array('0'=>6,'1'=>6) ),
	array( 'bpm' => 140, 'nn'  => 3, 'dd'  => 4, 'sf'  => 0, 'mi'  => 0 , 'direction' => array('0'=>7,'1'=>8) ),
	array( 'bpm' => 140, 'nn'  => 3, 'dd'  => 4, 'sf'  => 0, 'mi'  => 0 , 'direction' => array('0'=>8,'1'=>8) ),
	array( 'bpm' => 140, 'nn'  => 3, 'dd'  => 4, 'sf'  => 0, 'mi'  => 0 , 'direction' => array('0'=>9,'1'=>9) ),
	array( 'bpm' => 140, 'nn'  => 3, 'dd'  => 4, 'sf'  => 0, 'mi'  => 0 , 'direction' => array('0'=>0,'1'=>-1) ),
);
$birthday_song_content = array(
	'0.0' => array(
		array(
			'notename' => 'G+04',
			'start'    => '192',
			'length'   => '48',
			'velocity' => '127'
		),
		array(
			'notename' => 'G+04',
			'start'    => '240',
			'length'   => '48',
			'velocity' => '127'
		),
	),
	'0.1' => array(
		array(
			'notename' => 'A+04',
			'start'    => '0',
			'length'   => '96',
			'velocity' => '127'
		),
		array(
			'notename' => 'G+04',
			'start'    => '96',
			'length'   => '96',
			'velocity' => '127'
		),
		array(
			'notename' => 'C+05',
			'start'    => '192',
			'length'   => '96',
			'velocity' => '127'
		),
	),
	'0.2' => array(
		array(
			'notename' => 'B+04',
			'start'    => '0',
			'length'   => '192',
			'velocity' => '127'
		),
		array(
			'notename' => 'G+04',
			'start'    => '192',
			'length'   => '48',
			'velocity' => '127'
		),
		array(
			'notename' => 'G+04',
			'start'    => '240',
			'length'   => '48',
			'velocity' => '127'
		),
	),
	'0.3' => array(
		array(
			'notename' => 'A+04',
			'start'    => '0',
			'length'   => '96',
			'velocity' => '127'
		),
		array(
			'notename' => 'G+04',
			'start'    => '96',
			'length'   => '96',
			'velocity' => '127'
		),
		array(
			'notename' => 'D+05',
			'start'    => '192',
			'length'   => '96',
			'velocity' => '127'
		),
	),
	'0.4' => array(
		array(
			'notename' => 'C+05',
			'start'    => '0',
			'length'   => '192',
			'velocity' => '127'
		),
		array(
			'notename' => 'G+04',
			'start'    => '192',
			'length'   => '48',
			'velocity' => '127'
		),
		array(
			'notename' => 'G+04',
			'start'    => '240',
			'length'   => '48',
			'velocity' => '127'
		),		
	),
	'0.5' => array(
		array(
			'notename' => 'G+05',
			'start'    => '0',
			'length'   => '96',
			'velocity' => '127'
		),
		array(
			'notename' => 'E+05',
			'start'    => '96',
			'length'   => '96',
			'velocity' => '127'
		),
		array(
			'notename' => 'C+05',
			'start'    => '192',
			'length'   => '96',
			'velocity' => '127'
		),		
	),
	'0.6' => array(
		array(
			'notename' => 'B+04',
			'start'    => '0',
			'length'   => '96',
			'velocity' => '127'
		),
		array(
			'notename' => 'A+04',
			'start'    => '96',
			'length'   => '384',
			'velocity' => '127'
		),	
	),
	'0.7' => array(
		array(
			'notename' => 'F+05',
			'start'    => '192',
			'length'   => '48',
			'velocity' => '127'
		),
		array(
			'notename' => 'F+05',
			'start'    => '240',
			'length'   => '48',
			'velocity' => '127'
		),
	),
	'0.8' => array(
		array(
			'notename' => 'E+05',
			'start'    => '0',
			'length'   => '96',
			'velocity' => '127'
		),
		array(
			'notename' => 'C+05',
			'start'    => '96',
			'length'   => '96',
			'velocity' => '127'
		),
		array(
			'notename' => 'D+05',
			'start'    => '192',
			'length'   => '96',
			'velocity' => '127'
		),		
	),
	'0.9' => array(
		array(
			'notename' => 'C+05',
			'start'    => '0',
			'length'   => '384',
			'velocity' => '127'
		),
	),
);
$birthday_song = array(
	'axis' => array(
		'track' => $birthday_song_track,
		'slot' => $birthday_song_slot,
	),
	'content' => $birthday_song_content,
);
$birthday_song_json = json_encode($birthday_song);
?>
<!DOCTYPE html5>
<html>
<head>
	<title>Player</title>
	<script src='/js/jquery-1.7.1.min.js' type='text/javascript' charset="utf-8"></script>
	<script src="/js/soundgap.basic.mx.js" type="text/javascript" ></script>
	<script src="/js/soundgap-midi.js" type="text/javascript" ></script>

	<script type="text/javascript">

	$(function(){

		var birthday_song_json = <?php echo $birthday_song_json; ?>;
		play_controller.init(birthday_song_json,function() {
			$('#load').hide();
		});

		$('#play').click(function(){
			play_controller.play();
		});
		$('#stop').click(function(){
			play_controller.stop();
		});

		$('#track_volumn').change(function(){
			var value = $(this).val();
			play_controller.track[0].app_setup.masterGainNode.gain.value=value/100;
		});
	});
	</script>
</head>
<body>
<div id="load">
	loading...
</div><!-- load -->
<button id="play">Play</button>
<button id="stop">Stop</button>
<input type="range" min="0" max="100" value="80"  id='track_volumn' />

</body>
</html>